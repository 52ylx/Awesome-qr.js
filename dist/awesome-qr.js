!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.AwesomeQR=e():t.AwesomeQR=e()}(this,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=2)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.loop=e.conditional=e.parse=void 0;e.parse=function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;if(Array.isArray(r))r.forEach((function(r){return t(e,r,n,i)}));else if("function"==typeof r)r(e,n,i,t);else{var o=Object.keys(r)[0];Array.isArray(r[o])?(i[o]={},t(e,r[o],n,i[o])):i[o]=r[o](e,n,i,t)}return n};e.conditional=function(t,e){return function(r,n,i,o){e(r,n,i)&&o(r,t,n,i)}};e.loop=function(t,e){return function(r,n,i,o){for(var a=[];e(r,n,i);){var s={};o(r,t,n,s),a.push(s)}return a}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.readBits=e.readArray=e.readUnsigned=e.readString=e.peekBytes=e.readBytes=e.peekByte=e.readByte=e.buildStream=void 0;e.buildStream=function(t){return{data:t,pos:0}};var n=function(){return function(t){return t.data[t.pos++]}};e.readByte=n;e.peekByte=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(e){return e.data[e.pos+t]}};var i=function(t){return function(e){return e.data.subarray(e.pos,e.pos+=t)}};e.readBytes=i;e.peekBytes=function(t){return function(e){return e.data.subarray(e.pos,e.pos+t)}};e.readString=function(t){return function(e){return Array.from(i(t)(e)).map((function(t){return String.fromCharCode(t)})).join("")}};e.readUnsigned=function(t){return function(e){var r=i(2)(e);return t?(r[1]<<8)+r[0]:(r[0]<<8)+r[1]}};e.readArray=function(t,e){return function(r,n,o){for(var a="function"==typeof e?e(r,n,o):e,s=i(t),l=new Array(a),u=0;u<a;u++)l[u]=s(r);return l}};e.readBits=function(t){return function(e){for(var r=function(t){return t.data[t.pos++]}(e),n=new Array(8),i=0;i<8;i++)n[7-i]=!!(r&1<<i);return Object.keys(t).reduce((function(e,r){var i=t[r];return i.length?e[r]=function(t,e,r){for(var n=0,i=0;i<r;i++)n+=t[e+i]&&Math.pow(2,r-i-1);return n}(n,i.index,i.length):e[r]=n[i.index],e}),{})}}},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.AwesomeQR=void 0;var a=r(3),s=r(5),l=r(9),u=o(r(10)),h=function(t){if("string"==typeof t){var e=new Image;return e.src=t,e}return t},c=function(){function t(e){var r=Object.assign({},e);Object.keys(t._defaultOptions).map((function(e){e in r||Object.defineProperty(r,e,{value:t._defaultOptions[e],enumerable:!0,writable:!0})})),this.options=r,this.canvas=a.createCanvas(e.size,e.size),this.canvasContext=this.canvas.getContext("2d"),this.qrCode=new l.QRCodeModel(-1,this.options.correctLevel),this.qrCode.addData(this.options.text),this.qrCode.make()}return t.prototype.draw=function(){var t=this;return new Promise((function(e){return t._draw().then(e)}))},t.prototype._clear=function(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},t._prepareRoundedCornerClip=function(t,e,r,n,i,o){t.beginPath(),t.moveTo(e,r),t.arcTo(e+n,r,e+n,r+i,o),t.arcTo(e+n,r+i,e,r+i,o),t.arcTo(e,r+i,e,r,o),t.arcTo(e,r,e+n,r,o),t.closePath()},t._getAverageRGB=function(t){var e,r,n=h(t),i={r:0,g:0,b:0},o=-4,s={r:0,g:0,b:0},l=0;r=n.naturalHeight||n.offsetHeight||n.height,e=n.naturalWidth||n.offsetWidth||n.width;var u,c=a.createCanvas(e,r).getContext("2d");if(!c)return i;c.drawImage(n,0,0);try{u=c.getImageData(0,0,e,r)}catch(t){return i}for(;(o+=20)<u.data.length;)u.data[o]>200||u.data[o+1]>200||u.data[o+2]>200||(++l,s.r+=u.data[o],s.g+=u.data[o+1],s.b+=u.data[o+2]);return s.r=~~(s.r/l),s.g=~~(s.g/l),s.b=~~(s.b/l),s},t._drawAlignProtector=function(t,e,r,n,i){t.clearRect((e-2)*n,(r-2)*i,5*n,5*i),t.fillRect((e-2)*n,(r-2)*i,5*n,5*i)},t._drawAlign=function(t,e,r,n,i){t.fillRect((e-2)*n,(r-2)*i,n,4*i),t.fillRect((e+2)*n,(r-2+1)*i,n,4*i),t.fillRect((e-2+1)*n,(r-2)*i,4*n,i),t.fillRect((e-2)*n,(r+2)*i,4*n,i),t.fillRect(e*n,r*i,n,i)},t.prototype._draw=function(){var e;return n(this,void 0,void 0,(function(){var r,n,o,c,f,d,p,g,y,m,v,w,b,B,T,P,_,x,E,C,A,R,M,k,D,I,L,S,N,O,F,G,U,z,H,Q,j,K,q,X,Y,J,W,V,Z,$,tt,et,rt,nt,it,ot,at,st,lt,ut,ht;return i(this,(function(i){switch(i.label){case 0:if(r=null===(e=this.qrCode)||void 0===e?void 0:e.moduleCount,n=this.options.size,((o=this.options.margin)<0||2*o>=n)&&(o=0),c=Math.ceil(o),f=n-2*o,d=this.options.whiteMargin,p=this.options.backgroundDimming,g=Math.ceil(f/r),m=(y=g*r)+2*c,v=a.createCanvas(m,m),w=v.getContext("2d"),b=this.options.dotScale,this._clear(),b<=0||b>1)throw new Error("Scale should be in range (0, 1].");if(w.save(),w.translate(c,c),B=a.createCanvas(m,m),T=B.getContext("2d"),P=null,_=[],this.options.gifBackground){if(!(x=s.parseGIF(this.options.gifBackground)).raw.hasImages)throw new Error("An invalid gif has been selected as the background.");if(P=x,_=s.decompressFrames(x,!0),this.options.autoColor){for(E=0,C=0,A=0,R=0,j=0;j<_[0].colorTable.length;j++)(M=_[0].colorTable[j])[0]>200||M[1]>200||M[2]>200||0===M[0]&&0===M[1]&&0===M[2]||(R++,E+=M[0],C+=M[1],A+=M[2]);E=~~(E/R),C=~~(C/R),A=~~(A/R),this.options.colorDark="rgb("+E+","+C+","+A+")"}}else this.options.backgroundImage?(this.options.autoColor&&(k=t._getAverageRGB(this.options.backgroundImage),this.options.colorDark="rgb("+k.r+","+k.g+","+k.b+")"),D=h(this.options.backgroundImage),T.drawImage(D,0,0,D.width,D.height,0,0,m,m),T.rect(0,0,m,m),T.fillStyle=p,T.fill()):(T.rect(0,0,m,m),T.fillStyle="#ffffff",T.fill());for(I=l.QRUtil.getPatternPosition(this.qrCode.typeNumber),L=.5*(1-b),S=0;S<r;S++)for(N=0;N<r;N++){for(O=this.qrCode.isDark(S,N),F=N<8&&(S<8||S>=r-8)||N>=r-8&&S<8,G=6===S||6===N||F,j=0;j<I.length-1;j++)G=G||S>=I[j]-2&&S<=I[j]+2&&N>=I[j]-2&&N<=I[j]+2;U=N*g+(G?0:L*g),z=S*g+(G?0:L*g),w.strokeStyle=O?this.options.colorDark:this.options.colorLight,w.lineWidth=.5,w.fillStyle=O?this.options.colorDark:"rgba(255, 255, 255, 0.6)",G||(H=N<r-4&&N>=r-4-5&&S<r-4&&S>=r-4-5,0!==I.length&&H||w.fillRect(U,z,(G?1:b)*g,(G?1:b)*g))}for("rgba(255, 255, 255, 0.6)",w.fillStyle="rgba(255, 255, 255, 0.6)",w.fillRect(0,0,8*g,8*g),w.fillRect(0,(r-8)*g,8*g,8*g),w.fillRect((r-8)*g,0,8*g,8*g),w.fillRect(8*g,6*g,(r-8-8)*g,g),w.fillRect(6*g,8*g,g,(r-8-8)*g),Q=I[I.length-1],j=0;j<I.length;j++)for(K=0;K<I.length;K++)q=I[K],X=I[j],(6!==q||6!==X&&X!==Q)&&(6!==X||6!==q&&q!==Q)&&t._drawAlignProtector(w,q,X,g,g);for(w.fillStyle=this.options.colorDark,w.fillRect(0,0,7*g,g),w.fillRect((r-7)*g,0,7*g,g),w.fillRect(0,6*g,7*g,g),w.fillRect((r-7)*g,6*g,7*g,g),w.fillRect(0,(r-7)*g,7*g,g),w.fillRect(0,(r-7+6)*g,7*g,g),w.fillRect(0,0,g,7*g),w.fillRect(6*g,0,g,7*g),w.fillRect((r-7)*g,0,g,7*g),w.fillRect((r-7+6)*g,0,g,7*g),w.fillRect(0,(r-7)*g,g,7*g),w.fillRect(6*g,(r-7)*g,g,7*g),w.fillRect(2*g,2*g,3*g,3*g),w.fillRect((r-7+2)*g,2*g,3*g,3*g),w.fillRect(2*g,(r-7+2)*g,3*g,3*g),j=0;j<r-8;j+=2)w.fillRect((8+j)*g,6*g,g,g),w.fillRect(6*g,(8+j)*g,g,g);for(j=0;j<I.length;j++)for(K=0;K<I.length;K++)q=I[K],X=I[j],(6!==q||6!==X&&X!==Q)&&(6!==X||6!==q&&q!==Q)&&(6!==q&&q!==Q&&6!==X&&X!==Q?(w.fillStyle="rgba(0, 0, 0, .2)",t._drawAlign(w,q,X,g,g)):(w.fillStyle=this.options.colorDark,t._drawAlign(w,q,X,g,g)));if(d&&(w.fillStyle="#FFFFFF",w.fillRect(-c,-c,m,c),w.fillRect(-c,y,m,c),w.fillRect(y,-c,c,m),w.fillRect(-c,-c,c,m)),this.options.logoImage&&(Y=this.options.logoScale,J=this.options.logoMargin,W=this.options.logoCornerRadius,V=h(this.options.logoImage),(Y<=0||Y>=1)&&(Y=.2),J<0&&(J=0),W<0&&(W=0),w.restore(),tt=$=.5*(m-(Z=y*Y)),w.fillStyle="#FFFFFF",w.save(),t._prepareRoundedCornerClip(w,$-J,tt-J,Z+2*J,Z+2*J,W),w.clip(),w.fill(),w.restore(),w.save(),t._prepareRoundedCornerClip(w,$,tt,Z,Z,W),w.clip(),w.drawImage(V,$,tt,Z,Z),w.restore()),!P)return[3,2];if(_.forEach((function(t){et||(et=new u.default(n,n));var e=t.dims,r=e.width,i=e.height;void 0===rt&&(rt=a.createCanvas(r,i),(nt=rt.getContext("2d")).rect(0,0,rt.width,rt.height),nt.fillStyle="#ffffff",nt.fill()),it&&at&&r===it.width&&i===it.height||(it=a.createCanvas(r,i),ot=it.getContext("2d"),at=ot.createImageData(r,i)),at.data.set(t.patch),ot.putImageData(at,0,0),nt.drawImage(it,t.dims.left,t.dims.top);var o=a.createCanvas(m,m),s=o.getContext("2d");s.drawImage(rt,0,0,m,m),s.drawImage(v,0,0,m,m);var l=a.createCanvas(n,n).getContext("2d");l.drawImage(o,0,0,n,n),et.addFrame(l,{copy:!0,delay:t.delay})})),void 0===et)throw new Error("No frames.");return st=new Promise((function(t){return et.on("finished",(function(e){return t(e.arrayBuffer())}))})),et.render(),ut=(lt=Promise).resolve,[4,st];case 1:return[2,ut.apply(lt,[i.sent()])];case 2:return T.drawImage(v,0,0,m,m),w.drawImage(B,-c,-c,m,m),ht=a.createCanvas(n,n),ht.getContext("2d").drawImage(v,0,0,n,n),this.canvas=ht,[2,Promise.resolve(this.canvas.toBuffer())]}}))}))},t.CorrectLevel=l.QRErrorCorrectLevel,t._defaultOptions={text:"",size:800,margin:20,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:l.QRErrorCorrectLevel.M,backgroundImage:void 0,backgroundDimming:"rgba(0,0,0,0)",logoImage:void 0,logoScale:.2,logoMargin:6,logoCornerRadius:8,whiteMargin:!0,dotScale:.35,autoColor:!0},t}();e.AwesomeQR=c},function(t,e,r){const n=r(4);e.parseFont=n,e.createCanvas=function(t,e){return Object.assign(document.createElement("canvas"),{width:t,height:e})},e.createImageData=function(t,e,r){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(t);case 2:return new ImageData(t,e);default:return new ImageData(t,e,r)}},e.loadImage=function(t,e){return new Promise((function(r,n){const i=Object.assign(document.createElement("img"),e);function o(){i.onload=null,i.onerror=null}i.onload=function(){o(),r(i)},i.onerror=function(){o(),n(new Error('Failed to load the image "'+t+'"'))},i.src=t}))}},function(t,e,r){"use strict";const n="'([^']+)'|\"([^\"]+)\"|[\\w\\s-]+",i=new RegExp("(bold|bolder|lighter|[1-9]00) +","i"),o=new RegExp("(italic|oblique) +","i"),a=new RegExp("(small-caps) +","i"),s=new RegExp("(ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded) +","i"),l=new RegExp("([\\d\\.]+)(px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q) *((?:"+n+")( *, *(?:"+n+"))*)"),u={};t.exports=function(t){if(u[t])return u[t];const e=l.exec(t);if(!e)return;const r={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(e[1]),unit:e[2],family:e[3].replace(/["']/g,"").replace(/ *, */g,",")};let n,h,c,f,d=t.substring(0,e.index);switch((n=i.exec(d))&&(r.weight=n[1]),(h=o.exec(d))&&(r.style=h[1]),(c=a.exec(d))&&(r.variant=c[1]),(f=s.exec(d))&&(r.stretch=f[1]),r.unit){case"pt":r.size/=.75;break;case"pc":r.size*=16;break;case"in":r.size*=96;break;case"cm":r.size*=96/2.54;break;case"mm":r.size*=96/25.4;break;case"%":break;case"em":case"rem":r.size*=16/.75;break;case"q":r.size*=96/25.4/4}return u[t]=r}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decompressFrames=e.decompressFrame=e.parseGIF=void 0;var n,i=(n=r(6))&&n.__esModule?n:{default:n},o=r(0),a=r(1),s=r(7),l=r(8);e.parseGIF=function(t){var e=new Uint8Array(t);return(0,o.parse)((0,a.buildStream)(e),i.default)};var u=function(t,e,r){if(t.image){var n=t.image,i=n.descriptor.width*n.descriptor.height,o=(0,l.lzw)(n.data.minCodeSize,n.data.blocks,i);n.descriptor.lct.interlaced&&(o=(0,s.deinterlace)(o,n.descriptor.width));var a={pixels:o,dims:{top:t.image.descriptor.top,left:t.image.descriptor.left,width:t.image.descriptor.width,height:t.image.descriptor.height}};return n.descriptor.lct&&n.descriptor.lct.exists?a.colorTable=n.lct:a.colorTable=e,t.gce&&(a.delay=10*(t.gce.delay||10),a.disposalType=t.gce.extras.disposal,t.gce.extras.transparentColorGiven&&(a.transparentIndex=t.gce.transparentColorIndex)),r&&(a.patch=function(t){for(var e=t.pixels.length,r=new Uint8ClampedArray(4*e),n=0;n<e;n++){var i=4*n,o=t.pixels[n],a=t.colorTable[o];r[i]=a[0],r[i+1]=a[1],r[i+2]=a[2],r[i+3]=o!==t.transparentIndex?255:0}return r}(a)),a}console.warn("gif frame does not have associated image.")};e.decompressFrame=u;e.decompressFrames=function(t,e){return t.frames.filter((function(t){return t.image})).map((function(r){return u(r,t.gct,e)}))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(0),i=r(1),o={blocks:function(t){for(var e=[],r=0,n=(0,i.readByte)()(t);0!==n;n=(0,i.readByte)()(t))e.push((0,i.readBytes)(n)(t)),r+=n;for(var o=new Uint8Array(r),a=0,s=0;s<e.length;s++)o.set(e[s],a),a+=e[s].length;return o}},a=(0,n.conditional)({gce:[{codes:(0,i.readBytes)(2)},{byteSize:(0,i.readByte)()},{extras:(0,i.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,i.readUnsigned)(!0)},{transparentColorIndex:(0,i.readByte)()},{terminator:(0,i.readByte)()}]},(function(t){var e=(0,i.peekBytes)(2)(t);return 33===e[0]&&249===e[1]})),s=(0,n.conditional)({image:[{code:(0,i.readByte)()},{descriptor:[{left:(0,i.readUnsigned)(!0)},{top:(0,i.readUnsigned)(!0)},{width:(0,i.readUnsigned)(!0)},{height:(0,i.readUnsigned)(!0)},{lct:(0,i.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,n.conditional)({lct:(0,i.readArray)(3,(function(t,e,r){return Math.pow(2,r.descriptor.lct.size+1)}))},(function(t,e,r){return r.descriptor.lct.exists})),{data:[{minCodeSize:(0,i.readByte)()},o]}]},(function(t){return 44===(0,i.peekByte)()(t)})),l=(0,n.conditional)({text:[{codes:(0,i.readBytes)(2)},{blockSize:(0,i.readByte)()},{preData:function(t,e,r){return(0,i.readBytes)(r.text.blockSize)(t)}},o]},(function(t){var e=(0,i.peekBytes)(2)(t);return 33===e[0]&&1===e[1]})),u=(0,n.conditional)({application:[{codes:(0,i.readBytes)(2)},{blockSize:(0,i.readByte)()},{id:function(t,e,r){return(0,i.readString)(r.blockSize)(t)}},o]},(function(t){var e=(0,i.peekBytes)(2)(t);return 33===e[0]&&255===e[1]})),h=(0,n.conditional)({comment:[{codes:(0,i.readBytes)(2)},o]},(function(t){var e=(0,i.peekBytes)(2)(t);return 33===e[0]&&254===e[1]})),c=[{header:[{signature:(0,i.readString)(3)},{version:(0,i.readString)(3)}]},{lsd:[{width:(0,i.readUnsigned)(!0)},{height:(0,i.readUnsigned)(!0)},{gct:(0,i.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,i.readByte)()},{pixelAspectRatio:(0,i.readByte)()}]},(0,n.conditional)({gct:(0,i.readArray)(3,(function(t,e){return Math.pow(2,e.lsd.gct.size+1)}))},(function(t,e){return e.lsd.gct.exists})),{frames:(0,n.loop)([a,u,h,s,l],(function(t){var e=(0,i.peekByte)()(t);return 33===e||44===e}))}];e.default=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.deinterlace=void 0;e.deinterlace=function(t,e){for(var r=new Array(t.length),n=t.length/e,i=function(n,i){var o=t.slice(i*e,(i+1)*e);r.splice.apply(r,[n*e,e].concat(o))},o=[0,4,2,1],a=[8,8,4,2],s=0,l=0;l<4;l++)for(var u=o[l];u<n;u+=a[l])i(u,s),s++;return r}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.lzw=void 0;e.lzw=function(t,e,r){var n,i,o,a,s,l,u,h,c,f,d,p,g,y,m,v,w=r,b=new Array(r),B=new Array(4096),T=new Array(4096),P=new Array(4097);for(s=(i=1<<(f=t))+1,n=i+2,u=-1,o=(1<<(a=f+1))-1,h=0;h<i;h++)B[h]=0,T[h]=h;for(d=p=g=y=m=v=0,c=0;c<w;){if(0===y){if(p<a){d+=e[v]<<p,p+=8,v++;continue}if(h=d&o,d>>=a,p-=a,h>n||h==s)break;if(h==i){o=(1<<(a=f+1))-1,n=i+2,u=-1;continue}if(-1==u){P[y++]=T[h],u=h,g=h;continue}for(l=h,h==n&&(P[y++]=g,h=u);h>i;)P[y++]=T[h],h=B[h];g=255&T[h],P[y++]=g,n<4096&&(B[n]=u,T[n]=g,0==(++n&o)&&n<4096&&(a++,o+=n)),u=l}y--,b[m++]=P[y],c++}for(c=m;c<w;c++)b[c]=0;return b}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QRUtil=e.QRMaskPattern=e.QRMode=e.QRErrorCorrectLevel=e.QRCodeModel=void 0;var n=function(){function t(t,e){this.modules=[],this.dataCache=[],this.dataList=[],this.typeNumber=t,this.errorCorrectLevel=e}return Object.defineProperty(t.prototype,"moduleCount",{get:function(){return 4*this.typeNumber+17},enumerable:!1,configurable:!0}),t.prototype.addData=function(t){var e=new s(t);this.dataList.push(e),this.dataCache=[]},t.prototype.isDark=function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return!!this.modules[t][e]},t.prototype.make=function(){if(this.typeNumber<1){var t=1;for(t=1;t<40;t++){for(var e=c.getRSBlocks(t,this.errorCorrectLevel),r=new f,n=0,i=0;i<e.length;i++)n+=e[i].dataCount;for(i=0;i<this.dataList.length;i++){var o=this.dataList[i];r.put(o.mode,4),r.put(o.length,l.getLengthInBits(o.mode,t)),o.write(r)}if(r.length<=8*n)break}this.typeNumber=t}this.makeImpl(!1,this.getBestMaskPattern())},t.prototype.makeImpl=function(e,r){this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[n][i]=null}this._setupPositionProbePattern(0,0),this._setupPositionProbePattern(this.moduleCount-7,0),this._setupPositionProbePattern(0,this.moduleCount-7),this._setupPositionAdjustPattern(),this._setupTimingPattern(),this._setupTypeInfo(e,r),this.typeNumber>=7&&this._setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t._createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this._mapData(this.dataCache,r)},t.prototype._setupPositionProbePattern=function(t,e){for(var r=-1;r<=7;r++)if(!(t+r<=-1||this.moduleCount<=t+r))for(var n=-1;n<=7;n++)e+n<=-1||this.moduleCount<=e+n||(this.modules[t+r][e+n]=0<=r&&r<=6&&(0==n||6==n)||0<=n&&n<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=n&&n<=4)},t.prototype.getBestMaskPattern=function(){for(var t=0,e=0,r=0;r<8;r++){this.makeImpl(!0,r);var n=l.getLostPoint(this);(0==r||t>n)&&(t=n,e=r)}return e},t.prototype._setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},t.prototype._setupPositionAdjustPattern=function(){for(var t=l.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var r=0;r<t.length;r++){var n=t[e],i=t[r];if(null==this.modules[n][i])for(var o=-2;o<=2;o++)for(var a=-2;a<=2;a++)this.modules[n+o][i+a]=-2==o||2==o||-2==a||2==a||0==o&&0==a}},t.prototype._setupTypeNumber=function(t){for(var e=l.getBCHTypeNumber(this.typeNumber),r=0;r<18;r++){var n=!t&&1==(e>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=n}for(r=0;r<18;r++){n=!t&&1==(e>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=n}},t.prototype._setupTypeInfo=function(t,e){for(var r=this.errorCorrectLevel<<3|e,n=l.getBCHTypeInfo(r),i=0;i<15;i++){var o=!t&&1==(n>>i&1);i<6?this.modules[i][8]=o:i<8?this.modules[i+1][8]=o:this.modules[this.moduleCount-15+i][8]=o}for(i=0;i<15;i++){o=!t&&1==(n>>i&1);i<8?this.modules[8][this.moduleCount-i-1]=o:i<9?this.modules[8][15-i-1+1]=o:this.modules[8][15-i-1]=o}this.modules[this.moduleCount-8][8]=!t},t.prototype._mapData=function(t,e){for(var r=-1,n=this.moduleCount-1,i=7,o=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var s=0;s<2;s++)if(null==this.modules[n][a-s]){var u=!1;o<t.length&&(u=1==(t[o]>>>i&1)),l.getMask(e,n,a-s)&&(u=!u),this.modules[n][a-s]=u,-1==--i&&(o++,i=7)}if((n+=r)<0||this.moduleCount<=n){n-=r,r=-r;break}}},t._createData=function(e,r,n){for(var i=c.getRSBlocks(e,r),o=new f,a=0;a<n.length;a++){var s=n[a];o.put(s.mode,4),o.put(s.length,l.getLengthInBits(s.mode,e)),s.write(o)}var u=0;for(a=0;a<i.length;a++)u+=i[a].dataCount;if(o.length>8*u)throw new Error("code length overflow. ("+o.length+">"+8*u+")");for(o.length+4<=8*u&&o.put(0,4);o.length%8!=0;)o.putBit(!1);for(;!(o.length>=8*u||(o.put(t.PAD0,8),o.length>=8*u));)o.put(t.PAD1,8);return t._createBytes(o,i)},t._createBytes=function(t,e){for(var r=0,n=0,i=0,o=new Array(e.length),a=new Array(e.length),s=0;s<e.length;s++){var u=e[s].dataCount,c=e[s].totalCount-u;n=Math.max(n,u),i=Math.max(i,c),o[s]=new Array(u);for(var f=0;f<o[s].length;f++)o[s][f]=255&t.buffer[f+r];r+=u;var d=l.getErrorCorrectPolynomial(c),p=new h(o[s],d.length-1).mod(d);a[s]=new Array(d.length-1);for(f=0;f<a[s].length;f++){var g=f+p.length-a[s].length;a[s][f]=g>=0?p.get(g):0}}var y=0;for(f=0;f<e.length;f++)y+=e[f].totalCount;var m=new Array(y),v=0;for(f=0;f<n;f++)for(s=0;s<e.length;s++)f<o[s].length&&(m[v++]=o[s][f]);for(f=0;f<i;f++)for(s=0;s<e.length;s++)f<a[s].length&&(m[v++]=a[s][f]);return m},t.PAD0=236,t.PAD1=17,t}();e.QRCodeModel=n;var i,o,a,s=function(){function t(t){this.mode=o.MODE_8BIT_BYTE,this.data=t;for(var e=[],r=0,n=this.data.length;r<n;r++){var i=[],a=this.data.charCodeAt(r);a>65536?(i[0]=240|(1835008&a)>>>18,i[1]=128|(258048&a)>>>12,i[2]=128|(4032&a)>>>6,i[3]=128|63&a):a>2048?(i[0]=224|(61440&a)>>>12,i[1]=128|(4032&a)>>>6,i[2]=128|63&a):a>128?(i[0]=192|(1984&a)>>>6,i[1]=128|63&a):i[0]=a,e.push(i)}this.parsedData=Array.prototype.concat.apply([],e),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return Object.defineProperty(t.prototype,"length",{get:function(){return this.parsedData.length},enumerable:!1,configurable:!0}),t.prototype.write=function(t){for(var e=0,r=this.parsedData.length;e<r;e++)t.put(this.parsedData[e],8)},t}();!function(t){t[t.L=1]="L",t[t.M=0]="M",t[t.Q=3]="Q",t[t.H=2]="H"}(i=e.QRErrorCorrectLevel||(e.QRErrorCorrectLevel={})),function(t){t[t.MODE_NUMBER=1]="MODE_NUMBER",t[t.MODE_ALPHA_NUM=2]="MODE_ALPHA_NUM",t[t.MODE_8BIT_BYTE=4]="MODE_8BIT_BYTE",t[t.MODE_KANJI=8]="MODE_KANJI"}(o=e.QRMode||(e.QRMode={})),function(t){t[t.PATTERN000=0]="PATTERN000",t[t.PATTERN001=1]="PATTERN001",t[t.PATTERN010=2]="PATTERN010",t[t.PATTERN011=3]="PATTERN011",t[t.PATTERN100=4]="PATTERN100",t[t.PATTERN101=5]="PATTERN101",t[t.PATTERN110=6]="PATTERN110",t[t.PATTERN111=7]="PATTERN111"}(a=e.QRMaskPattern||(e.QRMaskPattern={}));var l=function(){function t(){}return t.getUTF8Length=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t.length?3:0)},t.getTypeNumber=function(e,r){for(var n=1,o=t.getUTF8Length(e),a=0,s=t.LIMIT_LENGTH.length;a<=s;a++){var l=0;switch(r){case i.L:l=t.LIMIT_LENGTH[a][0];break;case i.M:l=t.LIMIT_LENGTH[a][1];break;case i.Q:l=t.LIMIT_LENGTH[a][2];break;case i.H:l=t.LIMIT_LENGTH[a][3]}if(o<=l)break;n++}if(n>t.LIMIT_LENGTH.length)throw new Error("Too long data");return n},t.getBCHTypeInfo=function(e){for(var r=e<<10;t.getBCHDigit(r)-t.getBCHDigit(t.G15)>=0;)r^=t.G15<<t.getBCHDigit(r)-t.getBCHDigit(t.G15);return(e<<10|r)^t.G15_MASK},t.getBCHTypeNumber=function(e){for(var r=e<<12;t.getBCHDigit(r)-t.getBCHDigit(t.G18)>=0;)r^=t.G18<<t.getBCHDigit(r)-t.getBCHDigit(t.G18);return e<<12|r},t.getBCHDigit=function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},t.getPatternPosition=function(e){return t.PATTERN_POSITION_TABLE[e-1]},t.getMask=function(t,e,r){switch(t){case a.PATTERN000:return(e+r)%2==0;case a.PATTERN001:return e%2==0;case a.PATTERN010:return r%3==0;case a.PATTERN011:return(e+r)%3==0;case a.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case a.PATTERN101:return e*r%2+e*r%3==0;case a.PATTERN110:return(e*r%2+e*r%3)%2==0;case a.PATTERN111:return(e*r%3+(e+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},t.getErrorCorrectPolynomial=function(t){for(var e=new h([1],0),r=0;r<t;r++)e=e.multiply(new h([1,u.gexp(r)],0));return e},t.getLengthInBits=function(t,e){if(1<=e&&e<10)switch(t){case o.MODE_NUMBER:return 10;case o.MODE_ALPHA_NUM:return 9;case o.MODE_8BIT_BYTE:case o.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case o.MODE_NUMBER:return 12;case o.MODE_ALPHA_NUM:return 11;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case o.MODE_NUMBER:return 14;case o.MODE_ALPHA_NUM:return 13;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},t.getLostPoint=function(t){for(var e=t.moduleCount,r=0,n=0;n<e;n++)for(var i=0;i<e;i++){for(var o=0,a=t.isDark(n,i),s=-1;s<=1;s++)if(!(n+s<0||e<=n+s))for(var l=-1;l<=1;l++)i+l<0||e<=i+l||0==s&&0==l||a===t.isDark(n+s,i+l)&&o++;o>5&&(r+=3+o-5)}for(n=0;n<e-1;n++)for(i=0;i<e-1;i++){var u=0;t.isDark(n,i)&&u++,t.isDark(n+1,i)&&u++,t.isDark(n,i+1)&&u++,t.isDark(n+1,i+1)&&u++,0!=u&&4!=u||(r+=3)}for(n=0;n<e;n++)for(i=0;i<e-6;i++)t.isDark(n,i)&&!t.isDark(n,i+1)&&t.isDark(n,i+2)&&t.isDark(n,i+3)&&t.isDark(n,i+4)&&!t.isDark(n,i+5)&&t.isDark(n,i+6)&&(r+=40);for(i=0;i<e;i++)for(n=0;n<e-6;n++)t.isDark(n,i)&&!t.isDark(n+1,i)&&t.isDark(n+2,i)&&t.isDark(n+3,i)&&t.isDark(n+4,i)&&!t.isDark(n+5,i)&&t.isDark(n+6,i)&&(r+=40);var h=0;for(i=0;i<e;i++)for(n=0;n<e;n++)t.isDark(n,i)&&h++;return r+=10*(Math.abs(100*h/e/e-50)/5)},t.LIMIT_LENGTH=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],t.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],t.G15=1335,t.G18=7973,t.G15_MASK=21522,t}();e.QRUtil=l;var u=function(){function t(){}return t.glog=function(e){if(e<1)throw new Error("glog("+e+")");return t.LOG_TABLE[e]},t.gexp=function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return t.EXP_TABLE[e]},t.EXP_TABLE=new Array(256),t.LOG_TABLE=new Array(256),t._constructor=function(){for(var e=0;e<8;e++)t.EXP_TABLE[e]=1<<e;for(e=8;e<256;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(e=0;e<255;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e}(),t}(),h=function(){function t(t,e){if(null==t.length)throw new Error(t.length+"/"+e);for(var r=0;r<t.length&&0==t[r];)r++;this.num=new Array(t.length-r+e);for(var n=0;n<t.length-r;n++)this.num[n]=t[n+r]}return t.prototype.get=function(t){return this.num[t]},Object.defineProperty(t.prototype,"length",{get:function(){return this.num.length},enumerable:!1,configurable:!0}),t.prototype.multiply=function(e){for(var r=new Array(this.length+e.length-1),n=0;n<this.length;n++)for(var i=0;i<e.length;i++)r[n+i]^=u.gexp(u.glog(this.get(n))+u.glog(e.get(i)));return new t(r,0)},t.prototype.mod=function(e){if(this.length-e.length<0)return this;for(var r=u.glog(this.get(0))-u.glog(e.get(0)),n=new Array(this.length),i=0;i<this.length;i++)n[i]=this.get(i);for(i=0;i<e.length;i++)n[i]^=u.gexp(u.glog(e.get(i))+r);return new t(n,0).mod(e)},t}(),c=function(){function t(t,e){this.totalCount=t,this.dataCount=e}return t.getRSBlocks=function(e,r){var n=t.getRsBlockTable(e,r);if(null==n)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+r);for(var i=n.length/3,o=[],a=0;a<i;a++)for(var s=n[3*a+0],l=n[3*a+1],u=n[3*a+2],h=0;h<s;h++)o.push(new t(l,u));return o},t.getRsBlockTable=function(e,r){switch(r){case i.L:return t.RS_BLOCK_TABLE[4*(e-1)+0];case i.M:return t.RS_BLOCK_TABLE[4*(e-1)+1];case i.Q:return t.RS_BLOCK_TABLE[4*(e-1)+2];case i.H:return t.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},t.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],t}(),f=function(){function t(){this.buffer=[],this.length=0}return t.prototype.get=function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},t.prototype.put=function(t,e){for(var r=0;r<e;r++)this.putBit(1==(t>>>e-r-1&1))},t.prototype.putBit=function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++},t}()},function(t,e,r){var n=r(11),i=r(12);function o(){this.page=-1,this.pages=[],this.newPage()}o.pageSize=4096,o.charMap={};for(var a=0;a<256;a++)o.charMap[a]=String.fromCharCode(a);function s(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new o}o.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(o.pageSize),this.cursor=0},o.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var r=0;r<o.pageSize;r++)t+=o.charMap[this.pages[e][r]];return t},o.prototype.writeByte=function(t){this.cursor>=o.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t},o.prototype.writeUTFBytes=function(t){for(var e=t.length,r=0;r<e;r++)this.writeByte(t.charCodeAt(r))},o.prototype.writeBytes=function(t,e,r){for(var n=r||t.length,i=e||0;i<n;i++)this.writeByte(t[i])},s.prototype.setDelay=function(t){this.delay=Math.round(t/10)},s.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)},s.prototype.setDispose=function(t){t>=0&&(this.dispose=t)},s.prototype.setRepeat=function(t){this.repeat=t},s.prototype.setTransparent=function(t){this.transparent=t},s.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},s.prototype.finish=function(){this.out.writeByte(59)},s.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t},s.prototype.setDither=function(t){!0===t&&(t="FloydSteinberg"),this.dither=t},s.prototype.setGlobalPalette=function(t){this.globalPalette=t},s.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},s.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},s.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new n(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/)):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},s.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var r=0,n=0;n<e;n++){var i=this.findClosestRGB(255&this.pixels[r++],255&this.pixels[r++],255&this.pixels[r++]);this.usedEntry[i]=!0,this.indexedPixels[n]=i}},s.prototype.ditherPixels=function(t,e){var r={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!t||!r[t])throw"Unknown dithering kernel: "+t;var n=r[t],i=0,o=this.height,a=this.width,s=this.pixels,l=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var u=0;u<o;u++){e&&(l*=-1);for(var h=1==l?0:a-1,c=1==l?a:0;h!==c;h+=l){var f=3*(i=u*a+h),d=s[f],p=s[f+1],g=s[f+2];f=this.findClosestRGB(d,p,g),this.usedEntry[f]=!0,this.indexedPixels[i]=f,f*=3;for(var y=d-this.colorTab[f],m=p-this.colorTab[f+1],v=g-this.colorTab[f+2],w=1==l?0:n.length-1,b=1==l?n.length:0;w!==b;w+=l){var B=n[w][1],T=n[w][2];if(B+h>=0&&B+h<a&&T+u>=0&&T+u<o){var P=n[w][0];f=i+B+T*a,s[f*=3]=Math.max(0,Math.min(255,s[f]+y*P)),s[f+1]=Math.max(0,Math.min(255,s[f+1]+m*P)),s[f+2]=Math.max(0,Math.min(255,s[f+2]+v*P))}}}}},s.prototype.findClosest=function(t,e){return this.findClosestRGB((16711680&t)>>16,(65280&t)>>8,255&t,e)},s.prototype.findClosestRGB=function(t,e,r,n){if(null===this.colorTab)return-1;if(this.neuQuant&&!n)return this.neuQuant.lookupRGB(t,e,r);for(var i=0,o=16777216,a=this.colorTab.length,s=0,l=0;s<a;l++){var u=t-(255&this.colorTab[s++]),h=e-(255&this.colorTab[s++]),c=r-(255&this.colorTab[s++]),f=u*u+h*h+c*c;(!n||this.usedEntry[l])&&f<o&&(o=f,i=l)}return i},s.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var r=this.image,n=0,i=0,o=0;o<e;o++)for(var a=0;a<t;a++)this.pixels[i++]=r[n++],this.pixels[i++]=r[n++],this.pixels[i++]=r[n++],n++},s.prototype.writeGraphicCtrlExt=function(){var t,e;this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4),null===this.transparent?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=7&this.dispose),e<<=2,this.out.writeByte(0|e|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},s.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},s.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},s.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},s.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=768-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)},s.prototype.writeShort=function(t){this.out.writeByte(255&t),this.out.writeByte(t>>8&255)},s.prototype.writePixels=function(){new i(this.width,this.height,this.indexedPixels,this.colorDepth).encode(this.out)},s.prototype.stream=function(){return this.out},t.exports=s},function(t,e){t.exports=function(t,e){var r,n,i,o,a;function s(t,e,n,i,o){r[e][0]-=t*(r[e][0]-n)/1024,r[e][1]-=t*(r[e][1]-i)/1024,r[e][2]-=t*(r[e][2]-o)/1024}function l(t,e,n,i,o){for(var s,l,u=Math.abs(e-t),h=Math.min(e+t,256),c=e+1,f=e-1,d=1;c<h||f>u;)l=a[d++],c<h&&((s=r[c++])[0]-=l*(s[0]-n)/(1<<18),s[1]-=l*(s[1]-i)/(1<<18),s[2]-=l*(s[2]-o)/(1<<18)),f>u&&((s=r[f--])[0]-=l*(s[0]-n)/(1<<18),s[1]-=l*(s[1]-i)/(1<<18),s[2]-=l*(s[2]-o)/(1<<18))}function u(t,e,n){var a,s,l,u,h,c=~(1<<31),f=c,d=-1,p=d;for(a=0;a<256;a++)s=r[a],(l=Math.abs(s[0]-t)+Math.abs(s[1]-e)+Math.abs(s[2]-n))<c&&(c=l,d=a),(u=l-(i[a]>>12))<f&&(f=u,p=a),h=o[a]>>10,o[a]-=h,i[a]+=h<<10;return o[d]+=64,i[d]-=65536,p}this.buildColormap=function(){!function(){var t,e;for(r=[],n=new Int32Array(256),i=new Int32Array(256),o=new Int32Array(256),a=new Int32Array(32),t=0;t<256;t++)e=(t<<12)/256,r[t]=new Float64Array([e,e,e,0]),o[t]=256,i[t]=0}(),function(){var r,n,i,o,h,c,f=t.length,d=30+(e-1)/3,p=f/(3*e),g=~~(p/100),y=1024,m=2048,v=m>>6;for(v<=1&&(v=0),r=0;r<v;r++)a[r]=y*(256*(v*v-r*r)/(v*v));f<1509?(e=1,n=3):n=f%499!=0?1497:f%491!=0?1473:f%487!=0?1461:1509;var w=0;for(r=0;r<p;)if(s(y,c=u(i=(255&t[w])<<4,o=(255&t[w+1])<<4,h=(255&t[w+2])<<4),i,o,h),0!==v&&l(v,c,i,o,h),(w+=n)>=f&&(w-=f),0===g&&(g=1),++r%g==0)for(y-=y/d,(v=(m-=m/30)>>6)<=1&&(v=0),c=0;c<v;c++)a[c]=y*(256*(v*v-c*c)/(v*v))}(),function(){for(var t=0;t<256;t++)r[t][0]>>=4,r[t][1]>>=4,r[t][2]>>=4,r[t][3]=t}(),function(){var t,e,i,o,a,s,l=0,u=0;for(t=0;t<256;t++){for(a=t,s=(i=r[t])[1],e=t+1;e<256;e++)(o=r[e])[1]<s&&(a=e,s=o[1]);if(o=r[a],t!=a&&(e=o[0],o[0]=i[0],i[0]=e,e=o[1],o[1]=i[1],i[1]=e,e=o[2],o[2]=i[2],i[2]=e,e=o[3],o[3]=i[3],i[3]=e),s!=l){for(n[l]=u+t>>1,e=l+1;e<s;e++)n[e]=t;l=s,u=t}}for(n[l]=u+255>>1,e=l+1;e<256;e++)n[e]=255}()},this.getColormap=function(){for(var t=[],e=[],n=0;n<256;n++)e[r[n][3]]=n;for(var i=0,o=0;o<256;o++){var a=e[o];t[i++]=r[a][0],t[i++]=r[a][1],t[i++]=r[a][2]}return t},this.lookupRGB=function(t,e,i){for(var o,a,s,l=1e3,u=-1,h=n[e],c=h-1;h<256||c>=0;)h<256&&((s=(a=r[h])[1]-e)>=l?h=256:(h++,s<0&&(s=-s),(o=a[0]-t)<0&&(o=-o),(s+=o)<l&&((o=a[2]-i)<0&&(o=-o),(s+=o)<l&&(l=s,u=a[3])))),c>=0&&((s=e-(a=r[c])[1])>=l?c=-1:(c--,s<0&&(s=-s),(o=a[0]-t)<0&&(o=-o),(s+=o)<l&&((o=a[2]-i)<0&&(o=-o),(s+=o)<l&&(l=s,u=a[3]))));return u}}},function(t,e){var r=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];t.exports=function(t,e,n,i){var o,a,s,l,u,h,c=Math.max(2,i),f=new Uint8Array(256),d=new Int32Array(5003),p=new Int32Array(5003),g=0,y=0,m=!1;function v(t,e){f[a++]=t,a>=254&&B(e)}function w(t){b(5003),y=u+2,m=!0,_(u,t)}function b(t){for(var e=0;e<t;++e)d[e]=-1}function B(t){a>0&&(t.writeByte(a),t.writeBytes(f,0,a),a=0)}function T(t){return(1<<t)-1}function P(){return 0===remaining?-1:(--remaining,255&n[curPixel++])}function _(t,e){for(o&=r[g],g>0?o|=t<<g:o=t,g+=n_bits;g>=8;)v(255&o,e),o>>=8,g-=8;if((y>s||m)&&(m?(s=T(n_bits=l),m=!1):(++n_bits,s=12==n_bits?4096:T(n_bits))),t==h){for(;g>0;)v(255&o,e),o>>=8,g-=8;B(e)}}this.encode=function(r){r.writeByte(c),remaining=t*e,curPixel=0,function(t,e){var r,n,i,o,c,f;for(l=t,m=!1,n_bits=l,s=T(n_bits),h=(u=1<<t-1)+1,y=u+2,a=0,o=P(),f=0,r=5003;r<65536;r*=2)++f;f=8-f,b(5003),_(u,e);t:for(;-1!=(n=P());)if(r=(n<<12)+o,d[i=n<<f^o]!==r){if(d[i]>=0){c=5003-i,0===i&&(c=1);do{if((i-=c)<0&&(i+=5003),d[i]===r){o=p[i];continue t}}while(d[i]>=0)}_(o,e),o=n,y<4096?(p[i]=y++,d[i]=r):w(e)}else o=p[i];_(o,e),_(h,e)}(c+1,r),r.writeByte(0)}}}])}));